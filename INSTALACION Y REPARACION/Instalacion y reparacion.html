
<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8"/>
<title>HVAC – Editor GERA</title>

<style>
:root{
  --bg:#0d1117;
  --panel:#161b22;
  --border:#30363d;
  --text:#e6edf3;
  --muted:#8b949e;
}

*{box-sizing:border-box}

body{
  margin:0;
  font-family:system-ui,Segoe UI,Roboto,Arial;
  background:var(--bg);
  color:var(--text);
}

/* ===== TOP BAR ===== */
header{
  padding:8px 12px;
  background:var(--panel);
  border-bottom:1px solid var(--border);
  display:flex;
  gap:6px;
  flex-wrap:wrap;
}

button{
  background:#21262d;
  color:var(--text);
  border:1px solid var(--border);
  border-radius:8px;
  padding:6px 10px;
  cursor:pointer;
  font-size:13px;
}

/* ===== LAYOUT ===== */
.wrap{
  display:grid;
  grid-template-columns: 260px 1fr;
  height:calc(100vh - 46px);
}

/* ===== LEFT MENU ===== */
.panel{
  background:var(--panel);
  border-right:1px solid var(--border);
  padding:12px;
  overflow:auto;
}

.panel h3{
  margin:8px 0;
  font-size:13px;
  color:#fff;
}

.panel label{
  font-size:12px;
  color:var(--muted);
}

.panel input{
  width:100%;
  margin-bottom:8px;
  padding:6px;
  border-radius:6px;
  border:1px solid var(--border);
  background:#0b1220;
  color:#fff;
}

/* ===== STAGE ===== */
#stageWrap{
  display:flex;
  flex-direction:column;
  height:100%;
}

/* ===== SVG ===== */
svg{
  width:100%;
  height:100%;
  background:#0b1220;
  display:block;
}

/* GRID */
.gridline{
  stroke:#1f2733;
  stroke-width:1;
}

/* TEXT */
svg text{
  fill:#e6edf3;
  font-size:14px;
}
</style>
</head>

<body>

<header>
  <button id="btnExport">Exportar SVG</button>
</header>

<div class="wrap">

<!-- ===== LEFT MENU (CLIENT DATA) ===== -->
<div class="panel">
  <h3>DATOS DEL CLIENTE</h3>

  <label>Establecimiento</label>
  <input id="c_est" placeholder="Nombre del establecimiento">

  <label>CIF</label>
  <input id="c_cif">

  <label>Dirección</label>
  <input id="c_dir">

  <label>CP</label>
  <input id="c_cp">

  <label>Localidad</label>
  <input id="c_loc">
</div>

<!-- ===== STAGE ===== -->
<div id="stageWrap">
<svg id="svg" viewBox="0 0 1600 900"
     xmlns="http://www.w3.org/2000/svg">

  <!-- ===== HEADER SVG ===== -->
  <g id="docHeader"></g>

  <!-- ===== GRID ===== -->
  <g id="grid"></g>

</svg>
</div>

</div>

<script>
const NS="http://www.w3.org/2000/svg";
const svg=document.getElementById("svg");
const grid=document.getElementById("grid");
const header=document.getElementById("docHeader");

const H=180;

/* ===== GRID ===== */
function drawGrid(step=40){
  grid.innerHTML="";
  for(let x=0;x<=1600;x+=step){
    let l=document.createElementNS(NS,"line");
    l.setAttribute("x1",x);
    l.setAttribute("y1",H);
    l.setAttribute("x2",x);
    l.setAttribute("y2",900);
    l.setAttribute("class","gridline");
    grid.appendChild(l);
  }
  for(let y=H;y<=900;y+=step){
    let l=document.createElementNS(NS,"line");
    l.setAttribute("x1",0);
    l.setAttribute("y1",y);
    l.setAttribute("x2",1600);
    l.setAttribute("y2",y);
    l.setAttribute("class","gridline");
    grid.appendChild(l);
  }
}

/* ===== HEADER SVG ===== */
function renderHeader(){
  header.innerHTML="";

  let bg=document.createElementNS(NS,"rect");
  bg.setAttribute("x",0);
  bg.setAttribute("y",0);
  bg.setAttribute("width",1600);
  bg.setAttribute("height",H);
  bg.setAttribute("fill","#0b1220");
  header.appendChild(bg);

  let img=document.createElementNS(NS,"image");
  img.setAttribute("href","logotipo.jpg");
  img.setAttribute("x",40);
  img.setAttribute("y",30);
  img.setAttribute("width",260);
  img.setAttribute("height",120);
  img.setAttribute("preserveAspectRatio","xMidYMid meet");
  header.appendChild(img);

  const tx=(x,y,t,w=700)=>{
    let el=document.createElementNS(NS,"text");
    el.setAttribute("x",x);
    el.setAttribute("y",y);
    el.textContent=t;
    el.setAttribute("font-weight","700");
    header.appendChild(el);
  };

  tx(330,55,"GESTIÓN ECOLÓGICA DE RESIDUOS AVALON");
  tx(330,80,"G.E.R.A. S.L.  ·  B18600049");
  tx(330,105,"DISEÑO 38 – 18330 · CHAUCHINA · GRANADA");

  tx(900,55,"ESTABLECIMIENTO: "+c_est.value);
  tx(900,80,"CIF: "+c_cif.value);
  tx(900,105,"DIRECCIÓN: "+c_dir.value);
  tx(900,130,"CP: "+c_cp.value+"   LOCALIDAD: "+c_loc.value);
}

/* ===== INPUT BINDINGS ===== */
["c_est","c_cif","c_dir","c_cp","c_loc"].forEach(id=>{
  document.getElementById(id).addEventListener("input",renderHeader);
});

/* ===== EXPORT ===== */
document.getElementById("btnExport").onclick=()=>{
  const clone=svg.cloneNode(true);
  const data=new XMLSerializer().serializeToString(clone);
  const blob=new Blob([data],{type:"image/svg+xml"});
  const a=document.createElement("a");
  a.href=URL.createObjectURL(blob);
  a.download="hvac.svg";
  a.click();
};

/* INIT */
drawGrid();
renderHeader();
</script>

</body>
</html>
