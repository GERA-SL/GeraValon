
<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>SERVICIOS VARIOS – GeraValon</title>

  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#0d1117;
      --panel:#161b22;
      --border:#30363d;
      --text:#e6edf3;
      --muted:#8b949e;
      --hover:#0f1623;

      /* color del proyecto SERVICIOS VARIOS */
      --project:#a371f7;
    }

    *{ box-sizing:border-box; }

    body{
      margin:0;
      font-family:'Inter', system-ui, sans-serif;
      background:var(--bg);
      color:var(--text);
    }

    header{
      padding:18px 24px;
      border-bottom:1px solid var(--border);
      background:var(--panel);
    }

    .header-row{
      display:flex;
      align-items:center;
      gap:14px;
      max-width:900px;
      margin:0 auto;
    }

    .icon{
      width:30px;
      height:30px;
      border-radius:6px;
      background:var(--project);
      display:flex;
      align-items:center;
      justify-content:center;
      font-weight:800;
      font-size:14px;
      color:#0b0f14;
    }

    h1{
      margin:0;
      font-size:20px;
      font-weight:600;
      letter-spacing:.4px;
    }

    main{
      max-width:900px;
      margin:0 auto;
      padding:24px;
    }

    .block{
      background:var(--panel);
      border:1px solid var(--border);
      border-radius:10px;
      padding:20px;
      margin-bottom:24px;
    }

    .block-title{
      font-size:14px;
      font-weight:600;
      margin-bottom:16px;
      color:var(--muted);
      letter-spacing:.3px;
    }

    .field{
      display:flex;
      flex-direction:column;
      gap:6px;
      margin-bottom:16px;
    }

    label{
      font-size:13px;
      color:var(--muted);
    }

    input{
      background:#0f1623;
      border:1px solid var(--border);
      border-radius:8px;
      padding:10px 12px;
      color:var(--text);
      font-size:14px;
    }

    input:focus{
      outline:none;
      border-color:var(--project);
    }

    select{
      background:#0f1623;
      border:1px solid var(--border);
      border-radius:8px;
      padding:10px 12px;
      color:var(--text);
      font-size:14px;
    }

    select:focus{
      outline:none;
      border-color:var(--project);
    }

    /* cuando está deshabilitado */
    select:disabled{
      opacity:.55;
      cursor:not-allowed;
    }

    .row-fields{
      display:grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap:16px;
    }

    @media (max-width: 700px){
      .row-fields{
        grid-template-columns: 1fr;
      }
    }

    /* botones (para que peguen con el estilo) */
    .btn-row{
      display:flex;
      gap:10px;
      margin-top:10px;
    }

    button{
      border:1px solid var(--border);
      background:#0f1623;
      color:var(--text);
      padding:10px 12px;
      border-radius:8px;
      font-size:13px;
      cursor:pointer;
    }

    button:hover{
      border-color:var(--project);
    }

    button:disabled{
      opacity:.55;
      cursor:not-allowed;
    }

    .linea-sep{
      height:1px;
      background:var(--border);
      margin:16px 0;
      opacity:.6;
    }
  </style>
</head>

<body>

<header>
  <div class="header-row">
    <div class="icon">S</div>
    <h1>SERVICIOS VARIOS</h1>
  </div>
</header>

<main>

  <!-- BLOQUE 1 -->
  <div class="block">
    <div class="block-title">DATOS GENERALES</div>

    <div class="row-fields">
      <div class="field">
        <label for="fecha">FECHA</label>
        <input type="date" id="fecha">
      </div>

      <div class="field">
        <label for="cliente">CLIENTE</label>
        <input type="text" id="cliente" placeholder="Nombre del cliente">
      </div>

      <div class="field">
        <label for="ref">REFERENCIA (opcional)</label>
        <input type="text" id="ref" placeholder="Ej. Parte / pedido / etc.">
      </div>
    </div>
  </div>

  <!-- BLOQUE 2 -->
  <div class="block">
    <div class="block-title">TIPO DE SERVICIO</div>

    <!-- contenedor de líneas -->
    <div id="lineas-servicio">

      <!-- línea base -->
      <div class="row-fields linea-servicio">
        <div class="field">
          <label>CATEGORÍA</label>
          <select class="categoria" onchange="actualizarSubtipoLinea(this)">
            <option value="">Selecciona categoría</option>
            <option value="filtracion">FILTRACIÓN</option>
            <option value="extraccion">SISTEMA DE EXTRACCIÓN</option>
            <option value="grasa">SEPARADOR DE GRASA</option>
            <option value="ventilacion">VENTILACIÓN</option>
          </select>
        </div>

        <div class="field">
          <label>SUBTIPO</label>
          <select class="subtipo" disabled>
            <option value="">Selecciona primero una categoría</option>
          </select>
        </div>

        <div class="field">
          <label>DETALLE</label>
          <input type="text" class="detalle" placeholder="Observaciones / notas">
        </div>
      </div>

    </div>

    <div class="btn-row">
      <button type="button" onclick="agregarLinea()">GENERAR OTRA LÍNEA</button>
      <button type="button" onclick="aceptarLineas()">ACEPTAR</button>
      <button type="button" onclick="editarLineas()" id="btnEditar" disabled>EDITAR</button>
    </div>

    <div class="linea-sep"></div>
    <div style="color:var(--muted); font-size:13px;">
      Consejo: escribe 1 línea y pulsa “GENERAR OTRA LÍNEA” para añadir debajo (4 veces o las que quieras).
    </div>
  </div>

</main>

<script>
  // Subtipos por categoría
  const subtipos = {
    filtracion: [
      "FILTROS DE CAMPANA",
      "FILTROS DE FILTRONIC",
      "CARCASA DE FILTRONIC"
    ],
    extraccion: [
      "CAMPANA",
      "CAJA DE VENTILACION",
      "CONDUCTOS",
      "COCINA",
      "OTROS"
    ],
    grasa: [
      "MENOS DE 80 LITROS",
      "MAYOR DE 80 LITROS"
    ],
    ventilacion: [
      "CAJA DE VENTILACION",
      "CONDUCTOS",
      "REJILLAS",
      "OTROS"
    ]
  };

  // Actualiza el subtipo SOLO de la línea donde cambiaste categoría
  function actualizarSubtipoLinea(selectCategoria){
    const linea = selectCategoria.closest(".linea-servicio");
    const subtipo = linea.querySelector(".subtipo");
    const categoria = selectCategoria.value;

    subtipo.innerHTML = "";

    if(!categoria || !subtipos[categoria]){
      subtipo.disabled = true;
      subtipo.innerHTML = "<option value=''>Selecciona primero una categoría</option>";
      return;
    }

    subtipo.disabled = false;

    const first = document.createElement("option");
    first.value = "";
    first.textContent = "Selecciona subtipo";
    subtipo.appendChild(first);

    subtipos[categoria].forEach(opcion => {
      const opt = document.createElement("option");
      opt.value = opcion;
      opt.textContent = opcion;
      subtipo.appendChild(opt);
    });
  }

  // Genera otra línea igual debajo
  function agregarLinea(){
    const contenedor = document.getElementById("lineas-servicio");
    const base = contenedor.querySelector(".linea-servicio");
    const nueva = base.cloneNode(true);

    // limpiar valores
    nueva.querySelector(".categoria").value = "";
    const st = nueva.querySelector(".subtipo");
    st.innerHTML = "<option value=''>Selecciona primero una categoría</option>";
    st.disabled = true;
    nueva.querySelector(".detalle").value = "";

    contenedor.appendChild(nueva);
  }

  // Aceptar: bloquea todas las líneas
  function aceptarLineas(){
    document.querySelectorAll("#lineas-servicio select, #lineas-servicio input")
      .forEach(el => el.disabled = true);

    document.getElementById("btnEditar").disabled = false;
  }

  // Editar: vuelve a habilitar
  function editarLineas(){
    document.querySelectorAll("#lineas-servicio select, #lineas-servicio input")
      .forEach(el => el.disabled = false);

    // los subtipo vacíos deben seguir bloqueados hasta elegir categoría
    document.querySelectorAll("#lineas-servicio .linea-servicio").forEach(linea=>{
      const cat = linea.querySelector(".categoria").value;
      const st = linea.querySelector(".subtipo");
      if(!cat){
        st.disabled = true;
        st.innerHTML = "<option value=''>Selecciona primero una categoría</option>";
      }
    });

    document.getElementById("btnEditar").disabled = true;
  }
</script>

</body>
</html>
